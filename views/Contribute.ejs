<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    .product_container {
      height: auto;
      display: flex;
      flex-direction: row;
      justify-content: baseline;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
      padding: 10px;
    }

    .empty_product_container {
      height: 93vh;
      background-color: rgb(255, 242, 205);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;

    }

    .card {
      --bg-card: rgb(221, 221, 221);
      --primary: #050f0e;
      --primary-800: #15887e;
      --primary-shadow: #15887e;
      --light: #000000;
      --zinc-800: #448ba0;
      --bg-linear: blue;
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      padding: 1rem;
      width: 20rem;
      background-color: var(--bg-card);
      border-radius: 1rem;
      border-radius: 22px;
      transition: 0.4s box-shadow ease-in-out;
      cursor: pointer;
    }

    .image_container {
      overflow: hidden;
      cursor: pointer;

      position: relative;
      z-index: 5;

      width: 100%;
      height: 8rem;
      background-color: var(--primary-800);

      border-radius: 0.5rem;
    }

    .image_container .image {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);

      width: 3rem;
      fill: var(--light);
    }

    .title {
      overflow: clip;

      width: 100%;

      font-size: 1.5rem;
      font-weight: 600;
      color: var(--light);
      text-transform: capitalize;
      text-wrap: nowrap;
      text-overflow: ellipsis;
    }

    .size {
      font-weight: 400;
      font-size: 1.1rem;
      color: var(--light);
    }

    .list-size {
      display: flex;
      align-items: center;
      gap: 0.25rem;

      margin-top: 0.25rem;
    }

    .list-size .item-list {
      list-style: none;
    }

    .list-size .item-list-button {
      cursor: pointer;
      background-color: rgb(12, 70, 65);

      font-size: 0.75rem;
      color: var(--light);

      border: 1px solid white;
      border-radius: 0.25rem;

      transition: all 0.3s ease-in-out;
    }

    .item-list-button:hover {
      border: 1px solid var(--light);
    }

    .item-list-button:focus {
      border: 1px solid var(--primary-shadow);
    }

    .action {
      display: flex;
      flex-direction: column;
    }

    .price {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--light);
    }

    .cart-button {
      cursor: pointer;

      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;

      font-weight: 500;
      color: white;
      text-wrap: nowrap;

      border: 1px solid white;
      border-radius: 0.5rem;
    }

    .cart-button .cart-icon {
      width: 2rem;
    }

    #errorMessage {
      position: absolute;
      top: 6%;
      right: 0;
      background-color: #d93a3a;
      color: white;
      padding: 10px;
      font-size: 20px;
      margin: 10px;
      border-radius: 4px;
      animation: message 0.3s ease-in-out;
    }

    #successMessage {
      position: absolute;
      top: 6%;
      right: 0;
      background-color: #4cd388;
      color: white;
      padding: 10px;
      font-size: 20px;
      margin: 10px;
      border-radius: 4px;
      animation: message 0.3s ease-in-out;
    }

    @keyframes message {
      0% {
        transform: scale(0);
      }

      100% {
        transform: scale(1);
      }
    }

    .update-Info {
      animation: updatepopover 0.4s 1 ease-in-out;
    }

    @keyframes updatepopover {
      0% {
        transform: scale(0);
      }

      100% {
        transform: scale(1);
      }
    }
  </style>
</head>

<body>
  <%- include('Nav') %>
    <% if (state) { %>
      <div class="product_container">
        <% items.forEach(item=> { %>
          <div class="card">
            <div class="image_container">
              <img src="data:<%= item.image.contentType %>;base64,<%= item.image.data.toString('base64') %>"
                alt="<%= item.itemName %>">
            </div>
            <div class="title">
              <span>
                <%= item.itemName %>
              </span>
            </div>
            <div class="size">
              <p>Description: <%= item.description %>
              </p>
              <p>Price: $<%= item.price %>
              </p>
              <p>Quantity: <%= item.quantity %>
              </p>
              <p>Category: <%= item.category %>
              </p>
            </div>
            <div class="action">
              <div class="price">
                <span>Price: $<%= item.price %></span>
              </div>
              <div class="flex ">
                <button class="cart-button bg-blue-600" popovertarget="updateinfo_<%= item._id %>">
                  <svg class="cart-icon" fill="#000000" viewBox="0 0 24 24" id="update-alt-2" data-name="Line Color"
                    xmlns="http://www.w3.org/2000/svg" class="icon line-color">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                      <path id="primary" d="M6,5H16a2,2,0,0,1,2,2v7"
                        style="fill: none; stroke: #ffffff; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;">
                      </path>
                      <path id="primary-2" data-name="primary" d="M18,19H8a2,2,0,0,1-2-2V10"
                        style="fill: none; stroke: #ffffff; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;">
                      </path>
                      <polyline id="secondary" points="15 11 18 14 21 11"
                        style="fill: none; stroke: #00ff59; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;">
                      </polyline>
                      <polyline id="secondary-2" data-name="secondary" points="9 13 6 10 3 13"
                        style="fill: none; stroke: #00ff59; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;">
                      </polyline>
                    </g>
                  </svg>
                  <span>Update</span>
                </button>
                <button class="cart-button bg-red-500" popovertarget="deleteinfo_<%= item._id %>">
                  <svg class="cart-icon" width="64px" height="64px" viewBox="-2.4 -2.4 28.80 28.80" fill="none"
                    xmlns="http://www.w3.org/2000/svg" stroke="#000000" transform="rotate(0)matrix(1, 0, 0, 1, 0, 0)">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                      <path d="M10 12V17" stroke="#ffffff" stroke-width="2.4" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                      <path d="M14 12V17" stroke="#ffffff" stroke-width="2.4" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                      <path d="M4 7H20" stroke="#ffffff" stroke-width="2.4" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                      <path d="M6 10V18C6 19.6569 7.34315 21 9 21H15C16.6569 21 18 19.6569 18 18V10" stroke="#ffffff"
                        stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z" stroke="#ffffff"
                        stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"></path>
                    </g>
                  </svg>
                  <span class="text-xl">Delete</span>
                </button>

              </div>
            </div>
          </div>
          <div id="updateinfo_<%= item._id %>"
            class="update-Info bg-gray-50 shadow-lg rounded-lg p-4 border-2 border-black" popover>
            <form id="updateForm_<%= item._id %>" action="/Contribute/Update?Updateid=<%= item._id %>"
              enctype="multipart/form-data" method="post" class="mt-4">
              <div class="text-center text-2xl font-bold">Update Form</div>
              <label for="itemName" class="block text-xl font-medium text-gray-700">Item Name</label>
              <input type="text" name="itemName" value="<%= item.itemName %>"
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                required>
              <label for="description" class="block text-xl font-medium text-gray-700">Description</label>
              <textarea name="description"
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 "
                required><%= item.description %></textarea>
              <label for="price" class="block text-xl font-medium text-gray-700">Price</label>
              <input type="number" name="price" value="<%= item.price %>"
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 "
                required>
              <label for="quantity" class="block text-xl font-medium text-gray-700">Quantity</label>
              <input type="number" name="quantity" value="<%= item.quantity %>"
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 "
                required>
              <label for="category" class="block text-xl font-medium text-gray-700">Category</label>
              <input type="text" name="category" value="<%= item.category %>"
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 "
                required>
              <label for="Updatedfile" class="block text-xl font-medium text-gray-700">Want to update image</label>
              <input type="file" name="Updatedfile" class="mt-1 mb-2">
              <button type="submit"
                class="mt-2 w-full inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                Update Item
              </button>
            </form>
          </div>
          <div id="deleteinfo_<%= item._id %>"
            class="update-Info bg-gray-50 shadow-lg rounded-lg p-4 border-2 border-black" popover>
            <form id="deleteinfo_<%= item._id %>" action="/Contribute/delete?deleteinfo=<%= item._id %>" method="post"
              class="mt-4">
              <input type="hidden" name="Name" value="<%= item.itemName%>">
              <div class="bg-gray-50 shadow-lg rounded-lg p-4 ">
                <p class="text-lg font-bold">Delete Item</p>
                <p class="text-lg text-gray-500">Are you sure you want to delete <span class="text-xl font-bold">
                    <%= item.itemName %>
                  </span>? This action cannot be undone.</p>
                <label for="confirmName" class="block text-sm font-medium text-gray-700 mt-4">Enter the item name to
                  confirm</label>
                <input type="text" name="confirmName"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                <button type="submit"
                  class="mt-4 w-full inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                  Delete Item
                </button>
              </div>
            </form>
          </div>



          <% if(success){ %>
            <div id="successMessage">
              <%= success %>
            </div>
            <% } %>

              <% if(error){ %>
                <div id="errorMessage">
                  <%= error %>
                </div>
                <% } %>


                  <% }) %>
                    <% } else { %>
                      <div class="empty_product_container">
                        <div class="h-60 m-4">
                          <img class="h-60"
                            src="https://cdn.dribbble.com/users/1260892/screenshots/14512031/done_comp_3.gif"
                            alt="emptyProduct" />
                        </div>
                        <div class="text-xl font-bold text-black text-center">
                          Be First To Add Somethhing Here.
                        </div>
                      </div>
                      <% } %>
      </div>
      </div>

</body>
<script>
  document.addEventListener('DOMContentLoaded',()=>{
  setTimeout(() => {
    const successMessage = document.getElementById("successMessage");
    if (successMessage) {
      successMessage.style.display = "none";
    }
  }, 3000);
  console.log("hi johney")
  setTimeout(() => {
    const errorMessage = document.getElementById("errorMessage");
    if (errorMessage) {
      errorMessage.style.display = "none";
    }
  }, 3000);
});
</script>

</html>